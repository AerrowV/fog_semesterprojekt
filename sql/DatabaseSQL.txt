-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.address
(
    address_id serial NOT NULL,
    street_name character varying COLLATE pg_catalog."default",
    house_number character varying COLLATE pg_catalog."default",
    zip_code integer NOT NULL,
    CONSTRAINT address_pkey PRIMARY KEY (address_id)
);

CREATE TABLE IF NOT EXISTS public.carport_spec
(
    carport_id serial NOT NULL,
    carport_length integer NOT NULL,
    carport_width integer NOT NULL,
    carport_roof boolean NOT NULL,
    CONSTRAINT carport_spec_pkey PRIMARY KEY (carport_id)
);

CREATE TABLE IF NOT EXISTS public.material
(
    material_id serial NOT NULL,
    material_description character varying COLLATE pg_catalog."default" NOT NULL,
    material_length integer,
    material_amount integer NOT NULL,
    material_unit character varying COLLATE pg_catalog."default" NOT NULL,
    material_function character varying COLLATE pg_catalog."default" NOT NULL,
    material_price integer,
    CONSTRAINT material_pkey PRIMARY KEY (material_id)
);

CREATE TABLE IF NOT EXISTS public.material_spec
(
    material_spec_id serial NOT NULL,
    carport_id integer NOT NULL,
    material_id integer NOT NULL,
    material_order_amount integer NOT NULL,
    CONSTRAINT material_spec_pkey PRIMARY KEY (material_spec_id)
);

CREATE TABLE IF NOT EXISTS public."order"
(
    order_id serial NOT NULL,
    order_date timestamp without time zone NOT NULL,
    order_status character varying COLLATE pg_catalog."default" NOT NULL,
    user_id integer,
    carport_id integer,
    CONSTRAINT order_pkey PRIMARY KEY (order_id)
);

CREATE TABLE IF NOT EXISTS public.receipt
(
    receipt_id serial NOT NULL,
    receipt_paid_date timestamp without time zone,
    receipt_price integer NOT NULL,
    order_id integer,
    CONSTRAINT receipt_pkey PRIMARY KEY (receipt_id)
);

CREATE TABLE IF NOT EXISTS public.shed_spec
(
    shed_id serial NOT NULL,
    shed_length integer NOT NULL,
    shed_width integer NOT NULL,
    carport_id integer,
    CONSTRAINT shed_spec_pkey PRIMARY KEY (shed_id)
);

CREATE TABLE IF NOT EXISTS public."user"
(
    user_id serial NOT NULL,
    user_email character varying COLLATE pg_catalog."default" NOT NULL,
    user_password character varying(20) COLLATE pg_catalog."default" NOT NULL,
    is_admin boolean,
    first_name character varying COLLATE pg_catalog."default",
    last_name character varying COLLATE pg_catalog."default",
    address_id integer,
    CONSTRAINT user_pkey PRIMARY KEY (user_id),
    CONSTRAINT user_user_email_key UNIQUE (user_email)
);

CREATE TABLE IF NOT EXISTS public.zip_code
(
    zip_code integer NOT NULL,
    city character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT zip_code_pkey PRIMARY KEY (zip_code)
);

ALTER TABLE IF EXISTS public.address
    ADD CONSTRAINT fk_zip_code FOREIGN KEY (zip_code)
    REFERENCES public.zip_code (zip_code) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.material_spec
    ADD CONSTRAINT material_spec_carport_id_fkey FOREIGN KEY (carport_id)
    REFERENCES public.carport_spec (carport_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.material_spec
    ADD CONSTRAINT material_spec_material_id_fkey FOREIGN KEY (material_id)
    REFERENCES public.material (material_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."order"
    ADD CONSTRAINT order_carport_id_fkey FOREIGN KEY (carport_id)
    REFERENCES public.carport_spec (carport_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."order"
    ADD CONSTRAINT order_user_id_fkey FOREIGN KEY (user_id)
    REFERENCES public."user" (user_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.receipt
    ADD CONSTRAINT receipt_order_id_fkey FOREIGN KEY (order_id)
    REFERENCES public."order" (order_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.shed_spec
    ADD CONSTRAINT shed_spec_carport_id_fkey FOREIGN KEY (carport_id)
    REFERENCES public.carport_spec (carport_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public."user"
    ADD CONSTRAINT address_id FOREIGN KEY (address_id)
    REFERENCES public.address (address_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;
